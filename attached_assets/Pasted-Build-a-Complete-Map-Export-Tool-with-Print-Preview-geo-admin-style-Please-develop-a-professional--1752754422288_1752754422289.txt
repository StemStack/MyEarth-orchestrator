Build a Complete Map Export Tool with Print Preview (geo.admin-style)
Please develop a professional-grade map export tool for our CesiumJS app. This tool must allow users to generate high-quality, publication-ready PDF and PNG exports of the current map view, with a live print preview. The functionality and layout should closely follow the Swiss geoportal map.geo.admin.ch.

ğŸ§­ 1. Core Features
Add a â€œğŸ–¨ï¸ Print / Export Mapâ€ button to open the export interface.

Show a print preview panel styled like a PDF page (with margins, layout, metadata).

The preview must include:

Captured map view (using viewer.canvas.toDataURL(), html2canvas, or dom-to-image)

Metadata and layout elements described below

ğŸ“ 2. Page Size & Layout Options
Allow the user to choose:

Paper size: A5, A4, or A3

Orientation: Portrait or Landscape

Ensure the layout resizes responsively and maintains proper aspect ratio

Optional DPI setting (default to 150 DPI)

ğŸ—ºï¸ 3. Layout Content (geo.admin-style)
Include in the print/export layout:
âœ… Editable title field

âœ… Auto-filled metadata:

Center coordinates (lat/lon)

Zoom level

Current date/time

Active base + overlay layers

âœ… Auto-calculated scale bar:

Real-world measurement (e.g., â€œ5 kmâ€)

Line with label based on Cesium camera and resolution

âœ… Legend block:

List of active visible layers

Simple icons or colors (can be static or dynamic if available)

âœ… North arrow:

Fixed SVG or PNG, always pointing up

âœ… User notes field:

Multiline text area shown in the layout

âœ… Custom logo upload:

User can upload a logo image

Logo placed in corner of layout (top-left or bottom-left)

ğŸ§® 4. Advanced Extras
âœ… QR Code embed (optional but preferred):

Generate a QR code from the current map URL (use a free library)

Place in a bottom corner with a caption like â€œView onlineâ€

âœ… Coordinate grid overlay:

Draw UTM or lat/lon grid over map if toggled on

Show labeled grid lines in light gray

âœ… Custom scale override:

Let user optionally enter a target scale (e.g., â€œ1:25,000â€)

Layout auto-adjusts to fit that scale on chosen paper size

ğŸ“¤ 5. Export Tools
Provide buttons to export:

PDF (via html2pdf.js or jsPDF)

PNG (via html2canvas or dom-to-image)

Use the title and timestamp for the output filename

All export content must match the preview exactly

Include attribution (e.g., OpenStreetMap, OpenLandMap) in footer

ğŸ§¼ 6. Developer Guidelines
Clean and modular code:

createPrintPreview()

captureMapImage()

calculateScaleBar()

generateLegend()

exportAsPDF() / exportAsPNG()

Use CSS classes and avoid inline styles

Clearly comment all logic for future developers

No reliance on Cesium Ion â€” keep the app fully open-source

Do not alter the CesiumJS canvas â€” generate all layout in a separate DOM element